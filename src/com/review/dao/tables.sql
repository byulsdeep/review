/* drop all tables */
--DECLARE
--  l_sql LONG;
--BEGIN
--  FOR r IN (SELECT table_name FROM user_tables)
--  LOOP
--    l_sql := 'DROP TABLE ' || r.table_name || ' CASCADE CONSTRAINTS';
--    EXECUTE IMMEDIATE l_sql;
--  END LOOP;
--END;

CREATE TABLE MEMBERSHIP (
    MEM_CODE NCHAR(2) PRIMARY KEY,
    MEM_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE CUSTOMER (
    CUS_CODE       NVARCHAR2(500) PRIMARY KEY,
    CUS_NAME       NVARCHAR2(500) NOT NULL,
    CUS_PASSWORD   NVARCHAR2(64) NOT NULL,
    CUS_PHONE      NVARCHAR2(500) NOT NULL,
    CUS_EMAIL      NVARCHAR2(500) NOT NULL,
    CUS_ADDRESS    NVARCHAR2(500) NOT NULL,
    CUS_SIGNUPDATE DATE DEFAULT SYSDATE NOT NULL,
    CUS_MEMCODE    NCHAR(2),
    FOREIGN KEY ( CUS_MEMCODE )
        REFERENCES MEMBERSHIP ( MEM_CODE )
)
TABLESPACE USERS;

CREATE TABLE ACCESSLOG (
    ASL_CUSCODE NVARCHAR2(500),
    ASL_DATE    DATE DEFAULT SYSDATE,
    ASL_ACTION  NUMBER(1),
    PRIMARY KEY ( ASL_CUSCODE,
                  ASL_DATE,
                  ASL_ACTION ),
    FOREIGN KEY ( ASL_CUSCODE )
        REFERENCES CUSTOMER ( CUS_CODE )
)
TABLESPACE USERS;

CREATE TABLE CATEGORIES (
    CA_CODE NCHAR(2) PRIMARY KEY,
    CA_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE BRAND (
    BR_CODE NCHAR(2) PRIMARY KEY,
    BR_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE COUNTRY (
    CNT_CODE NCHAR(2) PRIMARY KEY,
    CNT_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE PRODUCT (
    PRD_CODE    NCHAR(4) PRIMARY KEY,
    PRD_NAME    NVARCHAR2(200) NOT NULL,
    PRD_COST    NUMBER(6) DEFAULT - 1 NOT NULL,
    PRD_PRICE   NUMBER(6) DEFAULT - 1 NOT NULL,
    PRD_CACODE  NCHAR(2),
    PRD_BRCODE  NCHAR(2),
    PRD_CNTCODE NCHAR(2),
    PRD_ONPROMO NUMBER(1) DEFAULT 0 NOT NULL,
    PRD_VISIBLE NUMBER(1) DEFAULT 1 NOT NULL,
    PRD_INFO    NVARCHAR2(2000),
    PRD_REGDATE DATE DEFAULT SYSDATE NOT NULL,
    FOREIGN KEY ( PRD_CACODE )
        REFERENCES CATEGORIES ( CA_CODE ),
    FOREIGN KEY ( PRD_BRCODE )
        REFERENCES BRAND ( BR_CODE ),
    FOREIGN KEY ( PRD_CNTCODE )
        REFERENCES COUNTRY ( CNT_CODE )
)
TABLESPACE USERS;

CREATE TABLE COLOR (
    CLR_CODE NCHAR(2) PRIMARY KEY,
    CLR_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE SIZING (
    SZ_CODE NCHAR(2) PRIMARY KEY,
    SZ_NAME NVARCHAR2(100) NOT NULL
)
TABLESPACE USERS;

CREATE TABLE PRODUCTVARIANTS (
    PVR_PRDCODE NCHAR(4),
    PVR_CLRCODE NCHAR(2),
    PVR_SZCODE  NCHAR(2),
    PVR_STOCK   NUMBER(3) DEFAULT - 1 NOT NULL,
    PRIMARY KEY ( PVR_PRDCODE,
                  PVR_CLRCODE,
                  PVR_SZCODE ),
    FOREIGN KEY ( PVR_PRDCODE )
        REFERENCES PRODUCT ( PRD_CODE ),
    FOREIGN KEY ( PVR_CLRCODE )
        REFERENCES COLOR ( CLR_CODE ),
    FOREIGN KEY ( PVR_SZCODE )
        REFERENCES SIZING ( SZ_CODE )
)
TABLESPACE USERS;

CREATE TABLE PRODUCTFILES (
    PFL_PRDCODE NCHAR(4),
    PFL_CODE    NUMBER(2),
    PFL_NAME    NVARCHAR2(50) NOT NULL,
    PFL_PATH    NVARCHAR2(100) NOT NULL,
    PFL_CLRCODE NCHAR(2),
    PRIMARY KEY ( PFL_PRDCODE,
                  PFL_CODE ),
    FOREIGN KEY ( PFL_PRDCODE )
        REFERENCES PRODUCT ( PRD_CODE ),
    FOREIGN KEY ( PFL_CLRCODE )
        REFERENCES COLOR ( CLR_CODE )
)
TABLESPACE USERS;

DROP PUBLIC SYNONYM ASL;
DROP PUBLIC SYNONYM BR;
DROP PUBLIC SYNONYM CA;
DROP PUBLIC SYNONYM CLR;
DROP PUBLIC SYNONYM CNT;
DROP PUBLIC SYNONYM CUS;
DROP PUBLIC SYNONYM MEM;
DROP PUBLIC SYNONYM PRD;
DROP PUBLIC SYNONYM PFL;
DROP PUBLIC SYNONYM PVR;
DROP PUBLIC SYNONYM SZ;
CREATE PUBLIC SYNONYM ASL FOR ACCESSLOG;
CREATE PUBLIC SYNONYM BR FOR BRAND;
CREATE PUBLIC SYNONYM CA FOR CATEGORIES;
CREATE PUBLIC SYNONYM CLR FOR COLOR;
CREATE PUBLIC SYNONYM CNT FOR COUNTRY;
CREATE PUBLIC SYNONYM CUS FOR CUSTOMER;
CREATE PUBLIC SYNONYM MEM FOR MEMBERSHIP;
CREATE PUBLIC SYNONYM PRD FOR PRODUCT;
CREATE PUBLIC SYNONYM PFL FOR PRODUCTFILES;
CREATE PUBLIC SYNONYM PVR FOR PRODUCTVARIANTS;
CREATE PUBLIC SYNONYM SZ FOR SIZING;



